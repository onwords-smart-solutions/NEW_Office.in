{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
    <link rel="stylesheet" href="{% static 'css/forms.css' %}">
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <link rel="shortcut icon" href="{% static 'images/favicon.ico' %}" type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <!-- chart js start  -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.6/Chart.bundle.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
    <!-- chart js end -->
    <title>adminconsole</title>
</head>

<body>
    <div class="main-con ">
        <div class="nav-con " onclick="navcon()">
            <nav class="px-2">
                <div class="container-fluid p-0 m-0">
                    <div class="navlistlogo">
                        <div class="left-nav-list">
                            <div class="menu-icon">
                                <img src="{% static 'images/nav-icon/small-icon.png' %}" alt="small_Icon"
                                    class="small-logo">
                                <img src="{% static 'images/close.png' %}" alt="menu_Icon" class="close-icons">
                            </div>
                        </div>
                        <div class="right-nav-list">
                            <img src="{% static 'images/nav-icon/main-log.svg' %}" alt="small_Icon" class="main-logo">
                        </div>
                    </div>
                    <div class="user-profile">
                        <li class="user-visual">
                            <div class="left-nav-list"> <img src="{% static 'images/menu.png' %}" alt="menu_Icon"
                                    class="menu-icons"></div>
                            <div class="right-nav-list">
                                <div class="user-profiles">
                                    <div class="user-img">
                                        <img src="{% static 'images/user-profile.svg' %}" alt="user-profile">
                                    </div>
                                    <div class="emply-id">
                                        <span>Vinith</span><br>
                                        <span>ID:WD002</span><br>
                                        <span>Web Developer</span>
                                    </div>
                                </div>
                            </div>
                        </li>

                    </div>
                    <ul id="nav-main-con">
                        <li class="navlistmenu" onclick="location.href='/ithome'">
                            <div class="left-nav-list">
                                <div class="menu-icon">
                                    <img src="{% static 'images/nav-icon/dashboard.svg' %}" alt="dashboard_Icon">
                                </div>
                            </div>
                            <div class="right-nav-list">
                                <h5>dashboard</h5>
                            </div>
                        </li>
                        <li class="navlistmenu navlistmenu-active" onclick="location.href='/leave_form'">
                            <div class="left-nav-list">
                                <div class="menu-icon">
                                    <img src="{% static 'images/nav-icon/forms-icon.svg' %}" alt="dashboard_Icon">
                                </div>
                            </div>
                            <div class="right-nav-list">
                                <h5>Leave Form</h5>
                            </div>
                        </li>
                        <li class="navlistmenu" onclick="location.href='/late_form'">
                            <div class="left-nav-list">
                                <div class="menu-icon">
                                    <img src="{% static 'images/nav-icon/late-icons.png' %}" alt="dashboard_Icon">
                                </div>
                            </div>
                            <div class="right-nav-list">
                                <h5>Late Form</h5>
                            </div>
                        </li>
                        <li class="navlistmenu" onclick="location.href='/suggestion'">
                            <div class="left-nav-list">
                                <div class="menu-icon">
                                    <img src="{% static 'images/nav-icon/suggestion.png' %}" alt="dashboard_Icon">
                                </div>
                            </div>
                            <div class="right-nav-list">
                                <h5>Suggestion</h5>
                            </div>
                        </li>
                    </ul>
                    <div class="logout" onclick="location.href=''">
                        <li class="navlistmenu">
                            <div class="left-nav-list">
                                <div class="menu-icon">
                                    <img src="{% static 'images/nav-icon/logout-icon.svg' %}" alt="dashboard_Icon"
                                        class="logout-icon">
                                </div>
                            </div>
                            <div class="right-nav-list">
                                <h5>Logout</h5>
                            </div>
                        </li>
                    </div>
                </div>
            </nav>
        </div>
        <div class="right-con " id="rightCon" onclick="rightcon()">

            <div class="container">
                <div class="forms-con">
                    <p class="active-form-li" id="newLeave">New Leave</p>
                    <p class="" id="leaveHistory">History</p>
                </div>

                <div id="leavem_con">
                    <div class="leave-form-con">
                        <div class="leave-list">
                            <div class="leave-lists" >
                                <p class=" formhov  active-forms" id="casualBtn">Casual</p>
                                <p id="sickBtn" class="formhov px-4">Sick</p>
                                <p id="permissionBtn" class="formhov">Permission</p>
                            </div>
                            <!-- casual leave -->
                            <div class="" id="casual-leaves">

                                <div class="leave-lists mt-3" >
                                    <p class=" formhov  active-forms" id="fulldayBtn" onclick="fullday()">Full Day</p>
                                    <p  class="formhov px-4" id="halfdayBtn" onclick="halfday()">Half Day</p>
                                    
                                </div>

                                <form action="/leave_form/" method="post" class="casual-leave leave-frm">
                                    {% csrf_token %}
                                  <div class="" id="halfday">
                                    <label for="from">Date</label>
                                    <div class="form-inp-con">
                                        <input type="date" id="Date" placeholder="Date" name="halfdate">
                                        <!-- <img src="{% static 'images/date-set.png' %}" alt="date-icpn"> -->
                                    </div>
                                  </div>
    
                                  <div id="fullday">
                                    <label for="leavefrom">From</label>
                                    <div class="form-inp-con">
                                        <input type="date" class="leavefrom" placeholder="From" name="fromdate">
                                        <!-- <img src="{% static 'images/date-set.png' %}" alt="date-icpn"> -->
                                    </div>
    
                                    <label for="leaveto">To</label>
                                    <div class="form-inp-con">
                                        <input type="date" class="leaveto" placeholder="To" name="todate">
                                        <!-- <img src="{% static 'images/date-set.png' %}" alt="date-icpn"> -->
                                    </div>
                                  </div>
                                    <label for="reason">Reason</label>
                                    <div class="form-inp-con">
                                        <input type="text" id="reason" placeholder="Reason" name="reason">
    
                                    </div>
                                    <input type="hidden" name="leave_type" value="general">
                                    <button class="primary-button">Submit</button>
                                </form>
                            </div>

                            <!-- casual leave end -->


                            <!-- casual sick start -->
                           <div class=""  id="sick-leave">
                            <div class="leave-lists mt-3" >
                                <p class=" formhov  active-forms" id="fulldaysickBtn" onclick="fulldaysick()">Full Day</p>
                                <p  class="formhov px-4" id="halfdaysickBtn" onclick="halfdaysick()">Half Day</p>
                                
                            </div>

                            <form action="/leave_form/" method="post" class="sick-leave leave-frm">
                                {% csrf_token %}

                                <div class="" id="halfdaysick">
                                    <label for="sick-half">Date</label>
                                    <div class="form-inp-con">
                                        <input type="date" class="" id="" placeholder="Date" name="halfdate">
                                        <!-- <img src="{% static 'images/date-set.png' %}" alt="date-icpn"> -->
                                    </div>
                                  </div>

                              
                                <div id="fulldaysick">
                                    <label for="leavefrom">From</label>
                                <div class="form-inp-con">
                                    <input type="date" class="leavefrom" placeholder="From" name="fromdate">
                                    <!-- <img src="{% static 'images/date-set.png' %}" alt="date-icpn"> -->
                                </div>

                                <label for="leaveto">To</label>
                                <div class="form-inp-con">
                                    <input type="date" class="leaveto" placeholder="To" name="todate">
                                    <!-- <img src="{% static 'images/date-set.png' %}" alt="date-icpn"> -->
                                </div>
                                </div>

                                <label for="reason">sick Reason</label>
                                <div class="form-inp-con">
                                    <input type="text" id="reason" placeholder="Reason" name="reason">
                                </div>
                                <input type="hidden" name="leave_type" value="sick">
                                <button class="primary-button">Submit</button>
                            </form>
                           </div>
                           <!-- sick end -->
                         
                            <form action="/leave_form/" method="post" class="leave-frm" id="permission">
                                {% csrf_token %}

                                <label for="reason">Reason</label>
                                <div class="form-inp-con">
                                    <input type="text" id="reason" placeholder="Reason" name="reason">
                                </div>
                                <div class="main-leave-con">
                                    <!-- <div class="">
                                        <label for="starttime">Duration<label><br>
                                        <div class="time-inp">
                                            <input type="time" id="starttime" name="duration">
                                        </div>
                                    </div> -->
                                    <div class="">
                                        <label for="endtime">Duration</label><br>
                                        <div class="time-inp">
                                            <input type="time" id="pertime" name="duration" required>
                                        </div>
                                    </div>
                                </div>
                                <input type="hidden" name="leave_type" value="permission">
                                <button class="primary-button">Submit</button>
                            </form>
                        </div>
                        <div class="leave-img">
                            <img src="{% static 'images/leave-frm-img.svg' %}" alt="leave-form" class="img-fluid">
                        </div>
                    </div>
                </div>
                <div class="leave-history" id="leaveHistorys">

                    <table class="table">
                        <thead>
                            <tr class="leave-table-head">
                                <th>Date</th>
                                <th>Reason</th>
                                <th>Action</th>
                                <th>Incharge</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for year, month, date, type, data in leavehistory %}
                            <tr class="table-body-li my-3">
                                <td>{{ data.date }}</td>
                                <td>{{ data.reason }}</td>
                                {% if data.status == "Approved" %}
                                <td>{{ data.status }}<img src="{% static 'images/approved-tick.png' %}" alt="approve-icon" class="img-fluid table-icon"></td>
                                {% elif data.status == "Declined" %}
                                <td>{{ data.status }}<img src="{% static 'images/decline-icon.png' %}" alt="decline-icon" class="img-fluid table-icon"></td>
                                {% else %}
                                <td>{{ data.status }}<img src="{% static 'images/pending-icon.png' %}" alt="decline-icon" class="img-fluid table-icon"></td>
                                {% endif %}
                                <td>{% if data.updated_by %}{{ data.updated_by }}{% else %}Pending{% endif %}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <!-- bootstrap js -->
    <script src="{% static 'js/bootstrap.bundle.js' %}"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <!-- js script  start -->
    <script src="{% static 'js/main.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
    <!-- js script  end -->
    <script>
        function validateDateRange(inputElement) {
            var fromElement = inputElement.form.querySelector('.leavefrom');
            var toElement = inputElement.form.querySelector('.leaveto');
    
            var fromDate = new Date(fromElement.value);
            var toDate = new Date(toElement.value);
    
            if (fromDate > toDate) {
                alert("From date cannot be greater than To date.");
                toElement.value = ''; 
            }
    
            var timeDiff = toDate - fromDate;
            var dayDiff = Math.ceil(timeDiff / (1000 * 3600 * 24));
    
            if (dayDiff > 2) {
                alert("Date range cannot exceed three days.");
                toElement.value = ''; 
            }
        }
    
        var toInputs = document.querySelectorAll('.leaveto');
        toInputs.forEach(function (toInput) {
            toInput.addEventListener('change', function () {
                validateDateRange(toInput);
            });
        });
    </script>
    <script>
        document.getElementById("pertime").addEventListener('change', function () {
            var selectedTime = this.value;
        
            var [hours, minutes] = selectedTime.split(':');
            var totalMinutes = parseInt(hours, 10) * 60 + parseInt(minutes, 10);

            if (totalMinutes > 240) {
                alert("Selected time exceeds 4 hours. Please select a time within 4 hours.");
                this.value = ''; 
            }
        });
    </script>
    
    
    

</body>

</html>

